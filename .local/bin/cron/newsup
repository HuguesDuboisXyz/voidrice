#!/bin/sh

# Set as a cron job to check for new RSS entries for newsboat.
# If newsboat is open, sends it an "R" key to refresh.

# Required to display notifications when run as a cronjob:
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/$(id -u)/bus
export DISPLAY=:0.0

ping -q -c 1 1.1.1.1 > /dev/null || exit

notify-send "ðŸ“° Updating RSS feeds..."

# pgrep -x newsboat >/dev/null && xdotool key --window "$(xdotool search --name newsboat)" R && exit

echo ðŸ”ƒ > /tmp/newsupdate
pkill -RTMIN+6 "${STATUSBAR:?}"
newsboat -x reload
rm -f /tmp/newsupdate
pkill -RTMIN+6 "${STATUSBAR:?}"
notify-send "ðŸ“° RSS feed update complete."
